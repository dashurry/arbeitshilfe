!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).printd={})}(this,function(t){"use strict";const e=/^(((http[s]?)|file):)?(\/\/)+([0-9a-zA-Z-_.=?&].+)$/,i=/^((\.|\.\.)?\/)([0-9a-zA-Z-_.=?&]+\/)*([0-9a-zA-Z-_.=?&]+)$/,n=t=>e.test(t)||i.test(t);function s(t,e){const i=t.createElement("style");return i.type="text/css",i.appendChild(window.document.createTextNode(e)),i}function r(t,e){const i=t.createElement("link");return i.type="text/css",i.rel="stylesheet",i.href=e,i}function a(t){const e=window.document.createElement("iframe");return e.setAttribute("src","about:blank"),e.setAttribute("style","visibility:hidden;width:0;height:0;position:absolute;z-index:-9999;bottom:0;"),e.setAttribute("width","0"),e.setAttribute("height","0"),e.setAttribute("wmode","opaque"),t.appendChild(e),e}const o={parent:window.document.body,headElements:[],bodyElements:[]};class d{constructor(t){this.isLoading=!1,this.hasEvents=!1,this.opts=[o,t||{}].reduce((t,e)=>(Object.keys(e).forEach(i=>t[i]=e[i]),t),{}),this.iframe=a(this.opts.parent)}getIFrame(){return this.iframe}print(t,e,i,a){if(this.isLoading)return;const{contentDocument:o,contentWindow:d}=this.iframe;if(!o||!d)return;if(this.iframe.src="about:blank",this.elCopy=t.cloneNode(!0),!this.elCopy)return;this.isLoading=!0,this.callback=a;const h=d.document;h.open(),h.write('<!DOCTYPE html><html><head><meta charset="utf-8"></head><body></body></html>'),this.addEvents();const{headElements:c,bodyElements:l}=this.opts;Array.isArray(c)&&c.forEach(t=>h.head.appendChild(t)),Array.isArray(l)&&l.forEach(t=>h.body.appendChild(t)),Array.isArray(e)&&e.forEach(t=>{t&&h.head.appendChild(n(t)?r(h,t):s(h,t))}),h.body.appendChild(this.elCopy),Array.isArray(i)&&i.forEach(t=>{if(t){const e=h.createElement("script");n(t)?e.src=t:e.innerText=t,h.body.appendChild(e)}}),h.close()}printURL(t,e){this.isLoading||(this.addEvents(),this.isLoading=!0,this.callback=e,this.iframe.src=t)}launchPrint(t){t.document.execCommand("print",!1,void 0)||t.print()}addEvents(){this.hasEvents||(this.hasEvents=!0,this.iframe.addEventListener("load",()=>this.onLoad(),!1))}onLoad(){if(this.iframe){this.isLoading=!1;const{contentDocument:t,contentWindow:e}=this.iframe;if(!t||!e)return;this.callback?this.callback({iframe:this.iframe,element:this.elCopy,launchPrint:()=>this.launchPrint(e)}):this.launchPrint(e)}}}t.createStyle=s,t.createLinkStyle=r,t.createIFrame=a,t.default=d,t.Printd=d,Object.defineProperty(t,"__esModule",{value:!0})});
